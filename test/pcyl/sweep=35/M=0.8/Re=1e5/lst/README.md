# Linear Stability Solves 

This directory has scripts and input files to aid in computing linear 
stability analysis for the parabolic cylinder. 

## Mean flow

The mean flow is computed in the directory immediately above this one and for
consistency (and ease) the runs herein use the solutions in the `../ref` 
directory so that you do not have to actually re-run the mean solution to
perform these LST calculations.

The mean solution is computed on a conformal mesh so as to correctly 
enforce the far-field potential solution.  There, the LST analysis is done
body-fitted mesh that is highly refined to capture the evolution of the
crossflow instability.

Likewise, the body-fitted mesh is, by definition, orthogonal to the surface
so that computation of boundary-layer statistics such as displacement and
momentum thickness, Hartree parameter, etc. are well defined.  For this 
reason, you will find a number of `gnuplot` script files (all ending in 
extension `.com` for quickingly plotting boundary layer statistics that
are generated by running `npost` with the `-t` option.

## Setup

There are two `setup` scripts provided.
  1. `setup-pro.sh` makes a body-fitted mesh starting at the attachment-line
     and runing for 30 nose radii downstream.  For some unknown reason, the
     metrics from the `pc` mesh generator are incorrect, so this script uses
     `pre` to recompute the correct metrics.  Then `interpc` utility is used
     to interpolate the reference mean solution, `../ref/mean.R.0` onto the
     new body-fitted mesh thereby generating a new `output.R.0` file.  Finally,
     `npost` is used to process `output.R.0` making the thickness statistics
     and generating a series of 384 velocity profiles used for LST.
  2. `setup-lst.sh` basically does a similar workflow but instead of
     generating profiles and thickness parameters, `npost` is run using the 
     `-l` option to generate `lstx.dat` and `lstq.dat` files and then `pre` 
     is run on `lstx.dat` to generated the required metrics stored in 
    `lstm.dat`.  

## $\beta$ Sweep

A sweep in $\beta \in [25,175]$ is performed by runing the `stab-beta.sh` 
script.  This script actually performed all the operations of `setup-pro.sh` 
so it can be run without first executing that script.  

## Curvature and Nonparallel Effects

There are three separate scripts for running various versions of LST to
assess curvature and nonparallel effects.
  1. The base quasi-parallel theory without curvature is run using `qpnc.sh`.
  2. Quasi-parallel theory with curvature is run using `qpwc.sh`.
  3. Nonparallel corrections with curvature are obtained running `npwc.sh`.
The quasi-parallel results use `stab` while the nonparallel correction are
based upon the results of the `qpwc.sh` eigenvalues and then polished with
nonparallel effects using `shoot`.  Note that `shoot` reads the `parm.nml` 
which specifies the parm.dat file to get the initial eigenvalue at each 
station. 

S. Scott Collis\
flow.physics.simulation@gmail.com
